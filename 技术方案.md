课程发布：
redis中的课程缓存信息是将课程发布表中的数据转为json进行存储。
elasticsearch中的课程索引信息是根据搜索需要将课程名称、课程介绍等信息进行索引存储。
MinIO中存储了课程的静态化页面文件（html网页），查看课程详情是通过文件系统去浏览课程详情页面。

分布式事务：
一次课程发布操作需要向数据库、redis、elasticsearch、MinIO写四份数据，这里存在分布式事务问题。


CAP理论:
Consistency 一致性 保证最新数据
Availability 可用性 可以查询到结果 但不保证最新数据
Partition tolerance 分区容错性: 当系统采用分布式架构时由于网络通信异常导致请求中断、消息丢失，但系统依然对外提供服务。
不可能同时满足三个特性。
由于是分布式系统就要满足分区容忍性，因为服务之间难免出现网络异常，不能因为局部网络异常导致整个系统不可用。
满足P那么C和A不能同时满足：

CP & AP AP 用户多一点
分布式事务控制有哪些常用的技术方案？
实现CP就是要实现强一致性:
使用Seata框架基于AT模式实现
使用Seata框架基于TCC模式实现。

实现AP则要保证最终数据一致性:
使用消息队列通知的方式去实现，通知失败自动重试，达到最大失败次数需要人工处理；
使用任务调度的方案，启动任务调度将课程信息由数据库同步到elasticsearch、MinIO、redis中。

微服务架构下：
单服务--多数据库
多服务---多数据库


微服务之间难免会存在远程调用，在Spring Cloud中可以使用Feign进行远程调用，
Feign是一个声明式的http客户端，官方地址：https://github.com/OpenFeign/feign
其作用就是帮助我们优雅的实现http请求的发送

如何解决由于微服务异常引起的雪崩效应呢？
可以采用熔断、降级的方法去解决。
熔断降级的相同点都是为了解决微服务系统崩溃的问题，但它们是两个不同的技术手段，两者又存在联系。


熔断：
当下游服务异常而断开与上游服务的交互，它就相当于保险丝，下游服务异常触发了熔断，从而保证上游服务不受影响。

降级：
当下游服务异常触发熔断后，上游服务就不再去调用异常的微服务而是执行了降级处理逻辑，这个降级处理逻辑可以是本地一个单独的方法。

项目使用Hystrix框架实现熔断、降级处理，在feign-dev.yaml中配置。

全文检索是指计算机索引程序通过扫描文章中的每一个词，对每一个词建立一个索引，
指明该词在文章中出现的次数和位置，当用户查询时，检索程序就根据事先建立的索引进行查找，并将查找的结果反馈给用户的检索方式。
这个过程类似于通过字典中的检索字表查字的过程。
全文检索可以简单理解为通过索引搜索文章。


本项目基于微服务架构构建，微服务包括：内容管理服务、媒资管理服务、学习中心服务、系统管理服务等，为了提高用户体验性，
用户只需要认证一次便可以在多个拥有访问权限的系统中访问，这个功能叫做单点登录。

认证框架:
如：Apache Shiro、CAS、Spring Security等。由于本项目基于Spring Cloud技术构建，
Spring Security是spring家族的一份子且和Spring Cloud集成的很好，所以本项目选用Spring Security作为认证服务的技术框架。


Spring Security支持OAuth2认证，OAuth2提供授权码模式、密码模式、简化模式、客户端模式等四种授权模式，
前边举的微信扫码登录的例子就是基于授权码模式，这四种模式中授权码模式和密码模式应用较多，
本节使用Spring Security演示授权码模式、密码模式，

传统的基于session的方式是有状态认证，用户登录成功将用户的身份信息存储在服务端，这样加大了服务端的存储压力，并且这种方式不适合在分布式系统中应用。


JWT 
第一部分 header
第二部分 payload
第三部分 加密签名

HS256：HMAC SHA256

白名单：
针对不用认证的URL全部放行。


网关认证，实现以下职责：
1、网站白名单维护
针对不用认证的URL全部放行。
2、校验jwt的合法性。
除了白名单剩下的就是需要认证的请求，网关需要验证jwt的合法性，jwt合法则说明用户身份合法，否则说明身份不合法则拒绝继续访问。


验证码可以防止恶性攻击，比如：XSS跨站脚本攻击、CSRF跨站请求伪造攻击，一些比较复杂的图形验证码可以有效的防止恶性攻击。



内网穿透
内网穿透简单来说就是将内网外网通过隧道打通,让内网的数据让外网可以获取。比如常用的办公室软件等，
一般在办公室或家里，通过拨号上网，
这样办公软件只有在本地的局域网之内才能访问，那么问题来了，如果是手机上，
或者公司外地的办公人员，如何访问到办公软件呢？这就需要内网穿透工具了。
开启隧道之后，网穿透工具会分配一个专属域名/端口,办公软件就已经在公网上了,
在外地的办公人员可以在任何地方愉快的访问办公软件了~~


RBAC 授权

基于角色的访问控制（Role-Based Access Control）
基于资源的访问控制（Resource-Based Access Control）

角色的访问控制（Role-Based Access Control）是按角色进行授权，
比如：主体的角色为总经理可以查询企业运营报表，查询员工工资信息等
if(主体.hasRole("总经理角色id") ||  主体.hasRole("部门经理角色id")){
查询工资
}

基于资源的访问控制（Resource-Based Access
Control）是按资源（或权限）进行授权，比如：用户必须具有查询工资权限才可以查询员工工资信息

if(主体.hasPermission("查询工资权限标识")){
查询工资
}

什么是细粒度授权？
细粒度授权也叫数据范围授权，即不同的用户所拥有的操作权限相同，但是能够操作的数据范围是不一样的。
一个例子：用户A和用户B都是教学机构，他们都拥有“我的课程”权限，但是两个用户所查询到的数据是不一样的。